<script cols="2">
  import querySchemas from "../commons/query.c.ejs"
  import addSchema from "../commons/add.c.ejs"
  import updateSchema from "../commons/update.c.ejs"
  import delSchema from "../commons/delete.c.ejs"
  export default [
    {
      type: "select",
      prop: "type",
      label: "类型",
      colspan: 2,
      default: "tree",
      options: [
        {label: "树", value: "tree"},
        {label: "列表", value: "list"},
      ]
    },
    ...querySchemas,
    addSchema,
    updateSchema,
    delSchema,
    {
      type: "table",
      prop: "components",
      label: "右侧组件",
      colspan: 2,
      schemas: [
        {type: "text", prop: "name", label: "组件id", colspan: 2},
        {
          type: "list",
          label: "配置组件",
          width: 70,
          dialogWidth: 800,
          schemas: [
            {
              type: "select",
              label: "选择组件",
              prop: "schemaId",
              options: [],
              async getOptions({ getAllSchemas }) {
                return (await getAllSchemas()).map(d => ({ label: d.name, value: d.id} ))
              },
              effect({model, resolveSchemas}) {
                if (model.schemaId) {
                  return {
                    prop: "itemSchemas",
                    key: model.schemaId,
                    schemas: resolveSchemas(model.schemaId)
                  }
                }
              }
            }
          ]
        }
      ]
    },
  ]
</script>

